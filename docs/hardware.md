# 硬件设计文档

## 系统架构概览

Poopal硬件系统采用模块化设计，主要包含以下核心组件：

### 主控制单元
- **微控制器**：ESP32-S3 (双核240MHz，支持WiFi和蓝牙)
- **内存配置**：512KB SRAM，8MB Flash存储
- **扩展接口**：GPIO、I2C、SPI、UART
- **电源管理**：集成充电管理芯片，支持USB-C充电

### 传感器模块

#### 1. 红外线检测阵列
- **型号**：8x8 PIR传感器矩阵
- **检测范围**：水平120°，垂直90°
- **响应时间**：<100ms
- **工作温度**：-10°C ~ +60°C
- **精度**：±5cm位置精度

#### 2. 热成像传感器
- **型号**：MLX90640 32x24像素
- **温度范围**：-40°C ~ +300°C
- **精度**：±1°C
- **帧率**：0.5Hz - 64Hz可调
- **接口**：I2C通信

#### 3. 重量传感器
- **类型**：应变式称重传感器
- **量程**：0-50kg
- **精度**：±10g
- **响应时间**：<50ms
- **防护等级**：IP65

#### 4. 气味检测传感器
- **类型**：多气体检测传感器
- **检测气体**：氨气、硫化氢等
- **检测范围**：0.1-1000ppm
- **响应时间**：<30s

### 执行器模块

#### 1. 自动投食器
- **投放机构**：步进电机驱动螺旋结构
- **容量**：500ml零食储存
- **投放精度**：1-3颗/次
- **材质**：食品级ABS塑料

#### 2. 音频系统
- **功放芯片**：MAX98357A
- **扬声器**：3W全频喇叭
- **音频格式**：MP3、WAV支持
- **音量范围**：0-100dB可调

#### 3. LED指示系统
- **类型**：WS2812B可编程RGB LED
- **数量**：16颗环形排列
- **控制方式**：数字信号控制
- **亮度调节**：256级可调

### 通信模块
- **WiFi**：802.11 b/g/n，2.4GHz
- **蓝牙**：BLE 5.0
- **云端连接**：MQTT协议
- **本地通信**：ESP-NOW点对点

### 电源系统
- **电池类型**：18650锂电池 3000mAh
- **充电接口**：USB-C
- **充电时间**：2-3小时
- **待机时间**：30-45天
- **工作时间**：连续工作5-7天

### 外壳设计
- **材质**：PC+ABS工程塑料
- **防护等级**：IP54
- **颜色**：象牙白/太空灰可选
- **尺寸**：200mm×150mm×80mm
- **重量**：650g

## 电路原理图

```
[主控制器ESP32-S3]
     |
     ├── [红外线传感器阵列] ── I2C总线
     ├── [热成像传感器] ──── I2C总线  
     ├── [重量传感器] ────── ADC接口
     ├── [气味传感器] ────── UART接口
     ├── [步进电机驱动] ──── GPIO控制
     ├── [音频功放] ──────── I2S接口
     ├── [LED控制器] ────── SPI接口
     └── [电源管理] ──────── 专用电源线路
```

## 安装要求

### 环境要求
- **温度**：5°C - 40°C工作环境
- **湿度**：20% - 80% RH
- **通风**：良好的空气流通
- **平面**：坚实平整的地面

### 安装步骤
1. 选择合适的安装位置
2. 连接电源适配器
3. 配置WiFi网络连接
4. 下载并安装手机App
5. 完成设备配对和校准

### 维护要求
- **清洁频率**：每周清洁外壳和传感器
- **校准周期**：每月进行一次传感器校准
- **固件更新**：自动检查并提示更新

## 技术规格表

| 项目 | 规格 |
|------|------|
| 工作电压 | 5V DC |
| 功耗 | 待机<1W，工作<5W |
| 检测精度 | 位置±5cm，重量±10g |
| 响应时间 | <100ms |
| 无线连接 | WiFi 2.4GHz，蓝牙5.0 |
| 存储容量 | 8MB本地存储 |
| 工作温度 | -10°C ~ +60°C |
| 存储温度 | -20°C ~ +70°C |
| 防护等级 | IP54 |

## 扩展接口

### 预留接口
- **USB-C**：调试和固件更新
- **GPIO扩展**：外接传感器
- **I2C总线**：扩展模块连接
- **电源输出**：5V/12V外设供电

### 可选配件
- **摄像头模块**：视觉识别增强
- **温湿度传感器**：环境监测
- **蜂鸣器**：声音提醒
- **振动电机**：触觉反馈

## 安全设计

### 电气安全
- **过压保护**：输入电压限制
- **短路保护**：自动断电功能
- **过热保护**：温度监控和控制
- **绝缘设计**：电气隔离处理

### 机械安全
- **圆角设计**：避免宠物受伤
- **无毒材料**：食品级安全材质
- **稳固底座**：防止倾倒
- **防咬设计**：线缆保护

### 数据安全
- **加密通信**：所有数据传输加密
- **本地处理**：核心算法本地运行
- **隐私保护**：不收集个人敏感信息
- **安全更新**：固件更新验证机制
